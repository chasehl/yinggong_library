<view class="container">
  
  <view class="header-bg"></view>

  <view class="user-card">
    
    <view class="user-info-row" bindtap="{{isLogin ? '' : 'toLogin'}}">
      <view class="avatar-wrap">
        <image 
          class="avatar" 
          src="{{isLogin ? userInfo.avatar : '/images/default-avatar.png'}}" 
          mode="aspectFill"
          catchtap="{{isLogin ? 'changeAvatar' : 'toLogin'}}"
        />
        <view class="edit-icon" wx:if="{{isLogin}}">ğŸ“·</view>
      </view>

      <view class="info-text">
        <block wx:if="{{isLogin}}">
          <view class="name-wrap" catchtap="editNickname">
            <text class="nickname">{{userInfo.nickName}}</text>
            <text class="edit-pen">âœ</text>
          </view>
          <text class="dept">{{userInfo.department || 'åº”ç”¨å·¥ç¨‹å­¦é™¢'}}</text>
        </block>
        <block wx:else>
          <text class="nickname">æœªç™»å½•</text>
          <text class="dept">ç‚¹å‡»ç™»å½•/æ³¨å†Œ</text>
        </block>
      </view>

      <view class="arrow-right" wx:if="{{!isLogin}}">></view>
    </view>

    <view class="stats-row" wx:if="{{isLogin}}">
      <view class="stats-item" bindtap="navTo" data-url="/pages/my-borrow/my-borrow">
        <text class="num">{{stats.borrowCount}}</text>
        <text class="label">å½“å‰å€Ÿé˜…</text>
      </view>
      <view class="stats-item" bindtap="navTo" data-url="/pages/my-reserve/my-reserve">
        <text class="num">{{stats.reserveCount}}</text>
        <text class="label">é¢„çº¦ä¸­</text>
      </view>
      <view class="stats-item">
        <text class="num">{{stats.messageCount}}</text>
        <text class="label">æœªè¯»æ¶ˆæ¯</text>
      </view>
      <view class="stats-item">
        <text class="num">{{stats.favoriteCount}}</text>
        <text class="label">æ”¶è—å›¾ä¹¦</text>
      </view>
    </view>
  </view>

  <view class="menu-group">
    <view class="menu-item" bindtap="navTo" data-url="/pages/bookshelf/bookshelf"> <view class="item-left">
        <image src="/images/tab/home.png" class="menu-icon" /> <text>æˆ‘çš„ä¹¦æ¶</text>
      </view>
      <text class="arrow">></text>
    </view>

    <view class="menu-item" bindtap="navTo" data-url="/pages/myborrow/myborrow">
      <view class="item-left">
        <image src="/images/icon-borrow.png" class="menu-icon" />
        <text>æˆ‘çš„å€Ÿé˜…</text>
      </view>
      <text class="arrow">></text>
    </view>

    <view class="menu-item" bindtap="navTo" data-url="/pages/my-reserve/my-reserve">
      <view class="item-left">
        <image src="/images/icon-reserve.png" class="menu-icon" />
        <text>æˆ‘çš„é¢„çº¦</text>
      </view>
      <text class="arrow">></text>
    </view>

    <view class="menu-item" bindtap="navTo" data-url="/pages/favorite/favorite">
      <view class="item-left">
        <image src="/images/icon-like.png" class="menu-icon" />
        <text>æˆ‘çš„æ”¶è—</text>
      </view>
      <text class="arrow">></text>
    </view>

    <view class="menu-item" bindtap="navTo" data-url="/pages/suggest/suggest">
      <view class="item-left">
        <image src="/images/icon-history.png" class="menu-icon" />
        <text>æˆ‘çš„èè´­</text>
      </view>
      <text class="arrow">></text>
    </view>

    <view class="menu-item last" bindtap="navTo" data-url="/pages/rule/rule">
      <view class="item-left">
        <image src="/images/icon-rule.png" class="menu-icon" />
        <text>è¯»è€…é¡»çŸ¥</text>
      </view>
      <text class="arrow">></text>
    </view>
  </view>

  <view class="menu-group">
    <view class="menu-item" bindtap="navTo" data-url="/pages/about/about">
      <view class="item-left">
        <icon type="info" size="18" color="#4a6fa5" class="menu-icon-sys"/>
        <text>å…³äºæˆ‘ä»¬</text>
      </view>
      <text class="arrow">></text>
    </view>

    <view class="menu-item" bindtap="navTo" data-url="/pages/faq/faq">
      <view class="item-left">
        <icon type="warn" size="18" color="#4a6fa5" class="menu-icon-sys"/>
        <text>å¸¸è§é—®é¢˜</text>
      </view>
      <text class="arrow">></text>
    </view>

    <view class="menu-item" bindtap="navTo" data-url="/pages/feedback/feedback">
      <view class="item-left">
        <icon type="waiting" size="18" color="#4a6fa5" class="menu-icon-sys"/>
        <text>æ„è§åé¦ˆ</text>
      </view>
      <text class="arrow">></text>
    </view>
  </view>
  
  <view class="logout-area" wx:if="{{isLogin}}">
    <button class="logout-btn" bindtap="handleLogout">é€€å‡ºç™»å½•</button>
  </view>

</view>