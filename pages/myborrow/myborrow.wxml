<view class="container">
  
  <view class="header-card">
    <view class="header-info">
      <view class="info-item">
        <text class="num">{{borrowList.length}}</text>
        <text class="label">å½“å‰å€Ÿé˜…</text>
      </view>
      <view class="divider"></view>
      <view class="info-item">
        <text class="num danger">{{overdueCount}}</text>
        <text class="label">å·²é€¾æœŸ</text>
      </view>
      <view class="divider"></view>
      <view class="info-item">
        <text class="num warning">{{expiringCount}}</text>
        <text class="label">å³å°†åˆ°æœŸ</text>
      </view>
    </view>
    <view class="header-tip">ğŸ’¡ æç¤ºï¼šæ¯æœ¬ä¹¦ä»…å¯ç»­å€Ÿä¸€æ¬¡ï¼Œé€¾æœŸå›¾ä¹¦ä¸å¯ç»­å€Ÿã€‚</view>
  </view>

  <scroll-view class="list-container" scroll-y="true">
    <block wx:for="{{borrowList}}" wx:key="id">
      <view class="book-card">
        
        <view class="card-body" bindtap="goToBookDetail" data-id="{{item.id}}">
          <image class="book-cover" src="{{item.cover}}" mode="aspectFill"></image>
          
          <view class="book-info">
            <view class="title-row">
              <text class="title">{{item.title}}</text>
            </view>
            <text class="author">{{item.author}}</text>
            
            <view class="meta-row">
              <text>å€Ÿé˜…æ—¥ï¼š{{item.borrowDate}}</text>
            </view>
            <view class="meta-row">
              <text>åº”è¿˜æ—¥ï¼š{{item.dueDate}}</text>
            </view>

            <view class="status-row">
              <text class="tag tag-danger" wx:if="{{item.daysLeft < 0}}">å·²é€¾æœŸ {{-item.daysLeft}} å¤©</text>
              <text class="tag tag-warning" wx:elif="{{item.daysLeft <= 3}}">å‰©ä½™ {{item.daysLeft}} å¤©</text>
              <text class="tag tag-normal" wx:else>å‰©ä½™ {{item.daysLeft}} å¤©</text>
            </view>
          </view>
        </view>

        <view class="card-action">
          <view class="renew-status" wx:if="{{item.renewed}}">å·²ç»­å€Ÿè¿‡</view>
          <view class="renew-status" wx:else>å¯ç»­å€Ÿ1æ¬¡</view>

          <button 
            class="renew-btn {{ (item.daysLeft < 0 || item.renewed) ? 'disabled' : ''}}" 
            size="mini" 
            bindtap="handleRenew" 
            data-index="{{index}}"
            disabled="{{item.daysLeft < 0 || item.renewed}}"
          >
            {{item.daysLeft < 0 ? 'éœ€å½’è¿˜' : (item.renewed ? 'å·²ç»­å€Ÿ' : 'ä¸€é”®ç»­å€Ÿ')}}
          </button>
        </view>

      </view>
    </block>

    <view class="empty-state" wx:if="{{borrowList.length === 0}}">
      <image src="/images/empty-box.png" mode="widthFix" class="empty-img" />
      <text>å½“å‰æ²¡æœ‰åœ¨å€Ÿå›¾ä¹¦</text>
    </view>
  </scroll-view>

</view>